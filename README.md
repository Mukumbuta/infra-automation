```md
# 🚀 Infrastructure as Code (IaC) for Automated Deployment  

This repository contains **Terraform** and **Ansible** configurations to provision and deploy the application automatically.  

## 📌 Features  
- **Cloud Infrastructure Provisioning:** Using Terraform  
- **Configuration Management:** Using Ansible  
- **Automated Deployment:** Using Docker & Docker Compose  
- **Single Command Setup:** Deploy the entire infrastructure with one command  
- **Security:** Configures security groups & enables SSL/TLS with Traefik  

## 📦 Technology Stack  
- **Terraform** (Infrastructure Provisioning)  
- **Ansible** (Configuration Management)  
- **Docker & Docker Compose** (Containerized Application Deployment)  
- **Traefik** (SSL/TLS & Reverse Proxy)  

## 🚀 Deployment Instructions  

### **1️⃣ Prerequisites**  
Ensure you have the following installed on your local machine:  
- **Terraform** (`v1.x.x` or later)  
- **Ansible** (`v2.x.x` or later)  
- **AWS CLI** (if using AWS)  
- **Git**  

### **2️⃣ Clone the Repository**  
```sh
git clone https://github.com/mukumbuta/infra-automation.git
cd infra-automation/terraform
```

### **3️⃣ Initialize Terraform**  
```sh
terraform init
```

### **4️⃣ Apply Terraform Configuration**  
Run the following command to provision servers and deploy the application:  

```sh
terraform apply -auto-approve
```

### **5️⃣ Access the Application**  
Once deployment is complete, access the application at:  

```
https://teafle.com
```

## 📂 Repository Structure  

```
infra-automation/
│── terraform/
│   ├── main.tf                # Terraform main configuration
│   ├── variables.tf            # Variable definitions
│   ├── outputs.tf              # Output variables
│   ├── inventory.tpl           # Ansible dynamic inventory template
│   ├── security_groups.tf      # Security group rules
│   ├── provisioners.tf         # Executes Ansible post-provisioning
│
│── ansible/
│   ├── roles/
│   │   ├── dependencies/       # Installs Docker, Docker Compose, etc.
│   │   ├── deployment/         # Clones repo, runs Docker Compose, sets up SSL
│   ├── inventory               # Inventory file generated by Terraform
│   ├── playbook.yml            # Main Ansible playbook
│
│── LICENSE
│── README.md
```

## ⚙️ Configuration & Environment Variables  

### **Terraform Variables**  
Modify `terraform/variables.tf` to set required values:  
```hcl
variable "aws_region" {
  default = "us-east-1"
}

variable "instance_type" {
  default = "t3.micro"
}

variable "public_key_path" {
  default = "~/.ssh/id_rsa.pub"
}
```

### **Ansible Playbook Configuration**  
The **Ansible playbook** (`ansible/playbook.yml`) performs the following tasks:  
✔️ Installs required packages (Docker, Git, etc.)  
✔️ Clones the application repository  
✔️ Runs `docker compose up -d`  
✔️ Configures SSL/TLS with Traefik  

## 🛠️ Troubleshooting  

### **Terraform Fails to Provision?**  
- Check if your AWS credentials are configured correctly:  
  ```sh
  aws configure
  ```
- Ensure your public SSH key exists at `~/.ssh/id_rsa.pub`.  

### **Ansible Playbook Fails?**  
- Verify SSH access:  
  ```sh
  ssh ubuntu@your-server-ip
  ```
- Run Ansible with verbose logging:  
  ```sh
  ansible-playbook -i inventory ansible/playbook.yml -vvvv
  ```

## ✨ Contributions  
Feel free to contribute by opening **issues** or submitting **pull requests**!  
